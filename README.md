# Hacking the Human Blood Vasculature in 3D

Семантическая сегментация изображений в настоящее время пользуется спросом в медицине, т.к. позволяет исключить человеческий фактор в процессе интерпретации медицинских снимков.
Цель настоящего соревнования - разработать модель сегментации кровеносных сосудов на КТ-снимках человеческих почек. 
Для решения задачи сегментации изображений была применена модель автокодировщика на базе архитектуры UNet. К достоинствам данной архитектуры можно отнести ее высокую эффективность и высокую скорость обучения за счет применения long skip connection между кодирующей частью модели (блоков сверточных слоев 3х3 с последующим пулингом 2х2) и декодером, восстанавливающим маску сегментации.
В качестве метрики качества использовалась метрика Surface Dice, рассчитываемая по формуле:

$$
Dice = \frac{2\times |A| \times |B|}{|A| + |B|}
$$

$A$ - предсказанная маска;
$B$ - оригинальная маска сегментации.

Обучалась модель на GPU Nvidia Tesla P100. Скорость обучения - 0.0001, количество эпох - 5. 
Обучающий датасет состоял из 1700 КТ снимков одной почки. Для обучения модели разбили данные в соотношении на обучающую и валидационную выборку в соотношении 3:1.
Для повышения точности модели и избежания переобучения применяли аугментации к изображениям с помощью библиотеки Albumentations.
Полученная модель показала высокое качество (Dice = 0.9079) на валидационной выборке, что сопоставимо по качеству с моделями других участников соревнования (применялись также модели на базе архитектуры SegFormer, дающих сопоставимое качество в рамках предложенной задачи).

Основные модули:
- main.py - запускает ML-пайплайн;
- model.py - содержит класс с UNet-моделью;
- src.py - содержит высокоуровневый интерфейс для обучения модели и загрузки решения на платформу Kaggle.

Ссылка на соревнование: https://kaggle.com/competitions/blood-vessel-segmentation
